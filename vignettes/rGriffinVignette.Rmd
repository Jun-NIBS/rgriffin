---
title: "rGriffin"
author: 
- name: Mariana E Martinez-Sanchez
- name: Stalin MuÃ±oz
- name: Miguel Carrillo
- name: Eugenio Azpeitia
- name: David Rosenblueth
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{rGriffin}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Introduction


## Queries

### Create a query

### Add restrictions to the query

### Run the query



## Connect to other packages

### BoolNet

The R package includes various functions to import and export data to `BoolNet`.

It is possible to obtain the topology of a `BooleanNetwork` object using `get.net.topology()`. This function determines the sign of each regulation as positive '+', negative '-' or ambiguous 'MA'. All regulations between nodes are considered mandatory. The function can also detect Non-functional regulations 'NR'.

```{r, echo=TRUE}
library(BoolNet)
data("cellcycle")
topology <- get.net.topology(cellcycle)
topology
```

It is also possible to convert an `AttractorInfo` object into a data.frame using `attractor2dataframe`.

```{r, echo=TRUE}
cc.attr <- getAttractors(cellcycle)
cycle <- attractor2dataframe(cc.attr)
cycle <- attr.df[cellcycle$genes]
cycle
```

Using this functions, it is possible to create a query that corresponds to a Boolean network. As we expect a cyclic attractor we will use `add.gquery.cycle()`.

```{r, echo=TRUE}
q <- create.gquery.graph(topology, cellcycle$genes)
q <- add.gquery.cycle(q, cycle)
print(q)
```

It is also possible to export the networks generated by `run.gquery()` directly to `BoolNet` with the option `return = "BoolNet"`. This option generates an iterator object, that returns the `BooleanNetwork` objects one by one using the function `iterators::nextElem()`. 

For example, if we use the three node example network:

```{r, include = FALSE}
genes = c('a','b','c')
inter = data.frame(source=c('a','b','b','c','c'), 
                  target=c('b','b','c','b','c'), 
                  type=c('+','+','-','-','+'),
                    stringsAsFactors = F )
q = create.gquery.graph(inter, genes)

attr = data.frame(a=c(0,'*',0), 
                 b=c(0,1,0), 
                 c=c(0,0,1),
                 stringsAsFactors = F )
q = add.gquery.attractors(q, attr)
```

```{r, echo=TRUE}
nets = run.gquery(q,return = "BoolNet")
iterators::nextElem(nets)
```

If there are no more available networks the `nextElem()` method will rise an error: `Error in obj$nextElem() : StopIteration`.


### Other

It is possible to plot the network topology dataframe with the R package `igraph`. This dataframe can also be used to import and export the network topology to other resources like the python library `networkx` or to the software `Cytoscape`.

It is possible to export the network functions as an SBML file using the `BoolNet` function `toSBML()`.





## References




```{r, echo=TRUE, results='asis'}
knitr::kable(head(mtcars, 10))
```

Also a quote using `>`:

> "He who gives up [code] safety for [code] speed deserves neither."
([via](https://twitter.com/hadleywickham/status/504368538874703872))
